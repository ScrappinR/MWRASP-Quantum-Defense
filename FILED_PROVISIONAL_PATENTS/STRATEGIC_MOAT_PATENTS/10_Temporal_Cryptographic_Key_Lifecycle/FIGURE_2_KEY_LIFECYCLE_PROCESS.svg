<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="900" viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title-text { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-anchor: middle; }
      .stage-text { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .label-text { font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; }
      .arrow { marker-end: url(#arrowhead); stroke: #333; stroke-width: 2; fill: none; }
      .process-arrow { marker-end: url(#arrowhead); stroke: #1976d2; stroke-width: 3; fill: none; }
      .generation-stage { fill: #e8f5e8; stroke: #4caf50; stroke-width: 2; rx: 8; }
      .distribution-stage { fill: #e3f2fd; stroke: #2196f3; stroke-width: 2; rx: 8; }
      .active-stage { fill: #fff3e0; stroke: #ff9800; stroke-width: 2; rx: 8; }
      .evolution-stage { fill: #f3e5f5; stroke: #9c27b0; stroke-width: 2; rx: 8; }
      .retirement-stage { fill: #ffebee; stroke: #f44336; stroke-width: 2; rx: 8; }
      .time-control { fill: #fff8e1; stroke: #fbc02d; stroke-width: 2; rx: 5; }
      .security-check { fill: #fce4ec; stroke: #e91e63; stroke-width: 2; rx: 5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" class="title-text">FIGURE 2: Temporal Key Lifecycle Management Process Flow</text>
  
  <!-- Stage 1: Key Generation -->
  <rect x="50" y="100" width="200" height="120" class="generation-stage"/>
  <text x="150" y="130" class="stage-text">1. KEY GENERATION</text>
  <text x="150" y="155" class="label-text">• Quantum Entropy Collection</text>
  <text x="150" y="170" class="label-text">• Post-Quantum Algorithm Selection</text>
  <text x="150" y="185" class="label-text">• Key Pair Generation</text>
  <text x="150" y="200" class="label-text">• Initial Temporal Parameters</text>
  
  <!-- Stage 2: Key Distribution -->
  <rect x="300" y="100" width="200" height="120" class="distribution-stage"/>
  <text x="400" y="130" class="stage-text">2. KEY DISTRIBUTION</text>
  <text x="400" y="155" class="label-text">• Secure Key Transport</text>
  <text x="400" y="170" class="label-text">• Time-Locked Distribution</text>
  <text x="400" y="185" class="label-text">• Access Window Assignment</text>
  <text x="400" y="200" class="label-text">• Recipient Verification</text>
  
  <!-- Stage 3: Active Usage -->
  <rect x="550" y="100" width="200" height="120" class="active-stage"/>
  <text x="650" y="130" class="stage-text">3. ACTIVE USAGE</text>
  <text x="650" y="155" class="label-text">• Temporal Access Validation</text>
  <text x="650" y="170" class="label-text">• Usage Monitoring</text>
  <text x="650" y="185" class="label-text">• Performance Tracking</text>
  <text x="650" y="200" class="label-text">• Security Compliance</text>
  
  <!-- Stage 4: Key Evolution -->
  <rect x="800" y="100" width="200" height="120" class="evolution-stage"/>
  <text x="900" y="130" class="stage-text">4. KEY EVOLUTION</text>
  <text x="900" y="155" class="label-text">• Automated Rotation Triggers</text>
  <text x="900" y="170" class="label-text">• Key Derivation</text>
  <text x="900" y="185" class="label-text">• Backward Compatibility</text>
  <text x="900" y="200" class="label-text">• Migration Coordination</text>
  
  <!-- Stage 5: Key Retirement -->
  <rect x="950" y="300" width="200" height="120" class="retirement-stage"/>
  <text x="1050" y="330" class="stage-text">5. KEY RETIREMENT</text>
  <text x="1050" y="355" class="label-text">• Secure Key Destruction</text>
  <text x="1050" y="370" class="label-text">• Audit Trail Completion</text>
  <text x="1050" y="385" class="label-text">• Compliance Verification</text>
  <text x="1050" y="400" class="label-text">• Archive Management</text>
  
  <!-- Temporal Controls -->
  <rect x="100" y="300" width="180" height="80" class="time-control"/>
  <text x="190" y="325" class="stage-text">Temporal Controls</text>
  <text x="190" y="345" class="label-text">• Time Window Enforcement</text>
  <text x="190" y="360" class="label-text">• Access Scheduling</text>
  <text x="190" y="375" class="label-text">• Temporal Policies</text>
  
  <rect x="320" y="300" width="180" height="80" class="time-control"/>
  <text x="410" y="325" class="stage-text">Evolution Triggers</text>
  <text x="410" y="345" class="label-text">• Time-Based Rotation</text>
  <text x="410" y="360" class="label-text">• Usage-Based Triggers</text>
  <text x="410" y="375" class="label-text">• Security Event Response</text>
  
  <rect x="540" y="300" width="180" height="80" class="time-control"/>
  <text x="630" y="325" class="stage-text">Access Validation</text>
  <text x="630" y="345" class="label-text">• Real-Time Validation</text>
  <text x="630" y="360" class="label-text">• Temporal Constraints</text>
  <text x="630" y="375" class="label-text">• Policy Compliance</text>
  
  <!-- Security Checkpoints -->
  <rect x="150" y="500" width="150" height="60" class="security-check"/>
  <text x="225" y="525" class="stage-text">Security Audit</text>
  <text x="225" y="545" class="label-text">Continuous Monitoring</text>
  
  <rect x="350" y="500" width="150" height="60" class="security-check"/>
  <text x="425" y="525" class="stage-text">Compliance Check</text>
  <text x="425" y="545" class="label-text">Policy Validation</text>
  
  <rect x="550" y="500" width="150" height="60" class="security-check"/>
  <text x="625" y="525" class="stage-text">Threat Assessment</text>
  <text x="625" y="545" class="label-text">Risk Evaluation</text>
  
  <rect x="750" y="500" width="150" height="60" class="security-check"/>
  <text x="825" y="525" class="stage-text">Migration Validation</text>
  <text x="825" y="545" class="label-text">Evolution Verification</text>
  
  <!-- Decision Points -->
  <ellipse cx="150" cy="420" rx="40" ry="25" fill="#ffecb3" stroke="#f57c00" stroke-width="2"/>
  <text x="150" y="425" class="label-text">Continue?</text>
  
  <ellipse cx="400" cy="420" rx="40" ry="25" fill="#ffecb3" stroke="#f57c00" stroke-width="2"/>
  <text x="400" y="425" class="label-text">Evolve?</text>
  
  <ellipse cx="650" cy="420" rx="40" ry="25" fill="#ffecb3" stroke="#f57c00" stroke-width="2"/>
  <text x="650" y="425" class="label-text">Rotate?</text>
  
  <ellipse cx="900" cy="420" rx="40" ry="25" fill="#ffecb3" stroke="#f57c00" stroke-width="2"/>
  <text x="900" y="425" class="label-text">Retire?</text>
  
  <!-- Process Flow Arrows -->
  <line x1="250" y1="160" x2="300" y2="160" class="process-arrow"/>
  <line x1="500" y1="160" x2="550" y2="160" class="process-arrow"/>
  <line x1="750" y1="160" x2="800" y2="160" class="process-arrow"/>
  <line x1="950" y1="180" x2="1000" y2="250" class="process-arrow"/>
  
  <!-- Evolution Loop -->
  <path d="M 900 220 Q 1100 250 1100 350 Q 1100 450 950 450 Q 800 450 650 420 Q 500 390 400 390" class="process-arrow" fill="none"/>
  
  <!-- Control Flow Arrows -->
  <line x1="150" y1="220" x2="150" y2="300" class="arrow"/>
  <line x1="400" y1="220" x2="400" y2="300" class="arrow"/>
  <line x1="650" y1="220" x2="650" y2="300" class="arrow"/>
  
  <!-- Security Checkpoint Connections -->
  <line x1="190" y1="380" x2="225" y2="500" class="arrow"/>
  <line x1="410" y1="380" x2="425" y2="500" class="arrow"/>
  <line x1="630" y1="380" x2="625" y2="500" class="arrow"/>
  <line x1="900" y1="380" x2="825" y2="500" class="arrow"/>
  
  <!-- Timeline -->
  <rect x="50" y="750" width="1100" height="60" fill="#f5f5f5" stroke="#ccc" stroke-width="1"/>
  <text x="100" y="775" class="stage-text">Timeline:</text>
  <text x="200" y="775" class="label-text">T0</text>
  <text x="350" y="775" class="label-text">T0 + Distribution</text>
  <text x="550" y="775" class="label-text">T1 - Active Period</text>
  <text x="750" y="775" class="label-text">T2 - Evolution</text>
  <text x="950" y="775" class="label-text">Tn - Retirement</text>
  <text x="600" y="795" class="label-text">Temporal Constraints: Access Windows | Evolution Triggers | Retirement Schedules</text>
  
  <!-- Legend -->
  <rect x="50" y="650" width="1100" height="50" fill="#f5f5f5" stroke="#ccc" stroke-width="1"/>
  <text x="600" y="680" class="label-text">Legend: Green = Generation | Blue = Distribution | Orange = Active | Purple = Evolution | Red = Retirement | Yellow = Temporal Controls | Pink = Security</text>
</svg>