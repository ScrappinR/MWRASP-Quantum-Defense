<svg width="1200" height="900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="mlGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="quantumGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00d4aa;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#007991;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="neuralGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff9a9e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fecfef;stop-opacity:1" />
    </linearGradient>
    <pattern id="dataPattern" x="0" y="0" width="15" height="15" patternUnits="userSpaceOnUse">
      <rect width="15" height="15" fill="#ecf0f1"/>
      <circle cx="7.5" cy="7.5" r="1.5" fill="#3498db" opacity="0.4"/>
    </pattern>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
    Figure 2: Machine Learning-Based Quantum Attack Detection Engine
  </text>
  
  <!-- Input Data Sources -->
  <rect x="50" y="80" width="1100" height="100" fill="url(#dataPattern)" stroke="#34495e" stroke-width="2" rx="10"/>
  <text x="600" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    Multi-Modal Input Data Sources
  </text>
  
  <!-- Data Source Boxes -->
  <rect x="80" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="140" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Network</text>
  <text x="140" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Traffic</text>
  <text x="140" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Packet Analysis</text>
  
  <rect x="220" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="280" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Crypto</text>
  <text x="280" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Operations</text>
  <text x="280" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Key Exchange</text>
  
  <rect x="360" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="420" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">System</text>
  <text x="420" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Behavior</text>
  <text x="420" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">CPU/Memory</text>
  
  <rect x="500" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="560" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Timing</text>
  <text x="560" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Analysis</text>
  <text x="560" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Side-Channel</text>
  
  <rect x="640" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="700" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Protocol</text>
  <text x="700" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Anomalies</text>
  <text x="700" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">QKD Attacks</text>
  
  <rect x="780" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="840" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Quantum</text>
  <text x="840" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Signatures</text>
  <text x="840" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Algorithm ID</text>
  
  <rect x="920" y="120" width="120" height="45" fill="#e8f4fd" stroke="#3498db" stroke-width="1" rx="5"/>
  <text x="980" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Threat Intel</text>
  <text x="980" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">Feeds</text>
  <text x="980" y="162" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">IoCs</text>
  
  <!-- Feature Extraction Layer -->
  <rect x="50" y="220" width="1100" height="80" fill="url(#neuralGradient)" stroke="#e91e63" stroke-width="2" rx="10"/>
  <text x="600" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
    Quantum Feature Extraction and Preprocessing Engine
  </text>
  
  <!-- Feature Extraction Components -->
  <rect x="100" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="175" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Shor's Algorithm</text>
  <text x="175" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Pattern Extraction</text>
  
  <rect x="270" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="345" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Grover's Search</text>
  <text x="345" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Signature Detection</text>
  
  <rect x="440" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="515" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Quantum Fourier</text>
  <text x="515" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Transform Analysis</text>
  
  <rect x="610" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="685" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Variational</text>
  <text x="685" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Algorithm Detection</text>
  
  <rect x="780" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="855" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Quantum</text>
  <text x="855" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Circuit Analysis</text>
  
  <rect x="950" y="260" width="150" height="30" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="3"/>
  <text x="1025" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#2c3e50">Error Pattern</text>
  <text x="1025" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#34495e">Correlation</text>
  
  <!-- ML Model Ensemble -->
  <rect x="50" y="340" width="1100" height="200" fill="url(#mlGradient)" stroke="#34495e" stroke-width="3" rx="10"/>
  <text x="600" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">
    Machine Learning Model Ensemble for Quantum Threat Detection
  </text>
  
  <!-- Neural Network Models -->
  <rect x="80" y="390" width="180" height="120" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="8"/>
  <text x="170" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Deep Neural Network</text>
  <text x="170" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Convolutional Layers</text>
  
  <!-- Neural network visualization -->
  <g transform="translate(90, 435)">
    <!-- Input layer -->
    <circle cx="20" cy="10" r="4" fill="#3498db"/>
    <circle cx="20" cy="25" r="4" fill="#3498db"/>
    <circle cx="20" cy="40" r="4" fill="#3498db"/>
    <circle cx="20" cy="55" r="4" fill="#3498db"/>
    
    <!-- Hidden layer 1 -->
    <circle cx="70" cy="15" r="4" fill="#e74c3c"/>
    <circle cx="70" cy="30" r="4" fill="#e74c3c"/>
    <circle cx="70" cy="45" r="4" fill="#e74c3c"/>
    
    <!-- Hidden layer 2 -->
    <circle cx="120" cy="20" r="4" fill="#f39c12"/>
    <circle cx="120" cy="40" r="4" fill="#f39c12"/>
    
    <!-- Output layer -->
    <circle cx="160" cy="30" r="4" fill="#27ae60"/>
    
    <!-- Connections -->
    <line x1="24" y1="10" x2="66" y2="15" stroke="#bdc3c7" stroke-width="1"/>
    <line x1="24" y1="25" x2="66" y2="30" stroke="#bdc3c7" stroke-width="1"/>
    <line x1="74" y1="15" x2="116" y2="20" stroke="#bdc3c7" stroke-width="1"/>
    <line x1="124" y1="20" x2="156" y2="30" stroke="#bdc3c7" stroke-width="2"/>
  </g>
  
  <rect x="290" y="390" width="180" height="120" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="8"/>
  <text x="380" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Transformer Model</text>
  <text x="380" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Attention Mechanism</text>
  <text x="380" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">Sequence Analysis</text>
  
  <!-- Attention visualization -->
  <g transform="translate(300, 450)">
    <rect x="10" y="10" width="15" height="35" fill="#3498db" opacity="0.7"/>
    <rect x="30" y="15" width="15" height="25" fill="#e74c3c" opacity="0.7"/>
    <rect x="50" y="5" width="15" height="40" fill="#f39c12" opacity="0.7"/>
    <rect x="70" y="20" width="15" height="20" fill="#27ae60" opacity="0.7"/>
    <rect x="90" y="8" width="15" height="35" fill="#9b59b6" opacity="0.7"/>
    <rect x="110" y="12" width="15" height="30" fill="#1abc9c" opacity="0.7"/>
    <rect x="130" y="18" width="15" height="25" fill="#34495e" opacity="0.7"/>
    <text x="75" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Attention Weights</text>
  </g>
  
  <rect x="500" y="390" width="180" height="120" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="8"/>
  <text x="590" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Random Forest</text>
  <text x="590" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Ensemble Learning</text>
  <text x="590" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">Decision Trees</text>
  
  <!-- Tree visualization -->
  <g transform="translate(520, 450)">
    <circle cx="70" cy="10" r="5" fill="#27ae60"/>
    <circle cx="40" cy="30" r="4" fill="#3498db"/>
    <circle cx="100" cy="30" r="4" fill="#e74c3c"/>
    <circle cx="25" cy="50" r="3" fill="#f39c12"/>
    <circle cx="55" cy="50" r="3" fill="#9b59b6"/>
    <circle cx="85" cy="50" r="3" fill="#1abc9c"/>
    <circle cx="115" cy="50" r="3" fill="#34495e"/>
    
    <line x1="70" y1="15" x2="40" y2="26" stroke="#2c3e50" stroke-width="1"/>
    <line x1="70" y1="15" x2="100" y2="26" stroke="#2c3e50" stroke-width="1"/>
    <line x1="40" y1="34" x2="25" y2="47" stroke="#2c3e50" stroke-width="1"/>
    <line x1="40" y1="34" x2="55" y2="47" stroke="#2c3e50" stroke-width="1"/>
  </g>
  
  <rect x="710" y="390" width="180" height="120" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="8"/>
  <text x="800" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Support Vector Machine</text>
  <text x="800" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Quantum Kernel</text>
  <text x="800" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">High-Dimensional</text>
  
  <!-- SVM visualization -->
  <g transform="translate(730, 450)">
    <circle cx="30" cy="20" r="3" fill="#3498db"/>
    <circle cx="40" cy="10" r="3" fill="#3498db"/>
    <circle cx="50" cy="25" r="3" fill="#3498db"/>
    <circle cx="90" cy="15" r="3" fill="#e74c3c"/>
    <circle cx="100" cy="25" r="3" fill="#e74c3c"/>
    <circle cx="110" cy="10" r="3" fill="#e74c3c"/>
    
    <line x1="60" y1="5" x2="80" y2="35" stroke="#2c3e50" stroke-width="2" stroke-dasharray="3,3"/>
    <text x="70" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#7f8c8d">Decision Boundary</text>
  </g>
  
  <rect x="920" y="390" width="180" height="120" fill="rgba(255,255,255,0.95)" stroke="#2c3e50" stroke-width="2" rx="8"/>
  <text x="1010" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">LSTM Network</text>
  <text x="1010" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Temporal Patterns</text>
  <text x="1010" y="440" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#7f8c8d">Memory Cells</text>
  
  <!-- LSTM visualization -->
  <g transform="translate(940, 450)">
    <rect x="10" y="10" width="25" height="15" fill="#3498db" rx="3"/>
    <rect x="40" y="10" width="25" height="15" fill="#e74c3c" rx="3"/>
    <rect x="70" y="10" width="25" height="15" fill="#f39c12" rx="3"/>
    <rect x="100" y="10" width="25" height="15" fill="#27ae60" rx="3"/>
    <rect x="130" y="10" width="25" height="15" fill="#9b59b6" rx="3"/>
    
    <path d="M35 17 Q50 5 55 17" stroke="#2c3e50" stroke-width="1" fill="none"/>
    <path d="M65 17 Q80 5 85 17" stroke="#2c3e50" stroke-width="1" fill="none"/>
    <path d="M95 17 Q110 5 115 17" stroke="#2c3e50" stroke-width="1" fill="none"/>
    <path d="M125 17 Q140 5 145 17" stroke="#2c3e50" stroke-width="1" fill="none"/>
  </g>
  
  <!-- Ensemble Voting System -->
  <rect x="50" y="580" width="1100" height="120" fill="url(#quantumGradient)" stroke="#34495e" stroke-width="3" rx="10"/>
  <text x="600" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">
    Ensemble Voting and Confidence Weighting System
  </text>
  
  <!-- Voting Components -->
  <rect x="100" y="630" width="200" height="50" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="5"/>
  <text x="200" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Weighted Voting Algorithm</text>
  <text x="200" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Model Performance History</text>
  
  <rect x="350" y="630" width="200" height="50" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="5"/>
  <text x="450" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Confidence Calibration</text>
  <text x="450" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Uncertainty Quantification</text>
  
  <rect x="600" y="630" width="200" height="50" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="5"/>
  <text x="700" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Threat Classification</text>
  <text x="700" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Multi-class Prediction</text>
  
  <rect x="850" y="630" width="200" height="50" fill="rgba(255,255,255,0.9)" stroke="#2c3e50" stroke-width="1" rx="5"/>
  <text x="950" y="650" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Timeline Estimation</text>
  <text x="950" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#34495e">Attack Window Prediction</text>
  
  <!-- Output Layer -->
  <rect x="50" y="740" width="1100" height="80" fill="#f8f9fa" stroke="#34495e" stroke-width="2" rx="10"/>
  <text x="600" y="765" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
    Quantum Threat Detection Output
  </text>
  
  <!-- Output Components -->
  <rect x="100" y="785" width="150" height="25" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3"/>
  <text x="175" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">HIGH THREAT</text>
  
  <rect x="270" y="785" width="150" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
  <text x="345" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">MEDIUM THREAT</text>
  
  <rect x="440" y="785" width="150" height="25" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3"/>
  <text x="515" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">LOW THREAT</text>
  
  <rect x="610" y="785" width="150" height="25" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="3"/>
  <text x="685" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">SHOR'S DETECTED</text>
  
  <rect x="780" y="785" width="150" height="25" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="3"/>
  <text x="855" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">GROVER'S DETECTED</text>
  
  <rect x="950" y="785" width="150" height="25" fill="#1abc9c" stroke="#16a085" stroke-width="1" rx="3"/>
  <text x="1025" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">QKD ATTACK</text>
  
  <!-- Data Flow Arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e"/>
    </marker>
  </defs>
  
  <!-- Input to Feature Extraction -->
  <path d="M600 180 L600 220" stroke="#34495e" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
  
  <!-- Feature Extraction to ML Models -->
  <path d="M600 300 L600 340" stroke="#34495e" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
  
  <!-- ML Models to Ensemble -->
  <path d="M600 540 L600 580" stroke="#34495e" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
  
  <!-- Ensemble to Output -->
  <path d="M600 700 L600 740" stroke="#34495e" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
  
  <!-- Performance Metrics -->
  <rect x="50" y="840" width="300" height="50" fill="white" stroke="#bdc3c7" stroke-width="1" rx="5"/>
  <text x="60" y="860" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Performance Metrics:</text>
  <text x="60" y="875" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Sub-millisecond detection time</text>
  <text x="60" y="885" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• 99.7% accuracy on quantum attacks</text>
  
  <rect x="370" y="840" width="300" height="50" fill="white" stroke="#bdc3c7" stroke-width="1" rx="5"/>
  <text x="380" y="860" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">Model Training:</text>
  <text x="380" y="875" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Synthetic quantum attack data</text>
  <text x="380" y="885" font-family="Arial, sans-serif" font-size="10" fill="#2c3e50">• Real-world network traces</text>
</svg>