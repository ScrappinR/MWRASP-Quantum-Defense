<svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1e3a8a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1e40af;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="level1Gradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#047857;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="level2Gradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#b91c1c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="level3Gradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6d28d9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="level4Gradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ea580c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c2410c;stop-opacity:1" />
    </linearGradient>
    <filter id="dropShadow">
      <feDropShadow dx="2" dy="2" stdDeviation="2" opacity="0.4"/>
    </filter>
    <marker id="moduleArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1e40af"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="900" fill="#f8fafc"/>
  
  <!-- Title Header -->
  <rect x="0" y="0" width="1400" height="50" fill="url(#headerGradient)"/>
  <text x="700" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="white">
    Figure 3: Modular Quantum-Safe Protocol Architecture - Security Level Configurations
  </text>

  <!-- Security Level Hierarchy -->
  <g id="securityLevels">
    <!-- Level 1: Ultra-Constrained Devices -->
    <rect x="50" y="70" width="320" height="180" fill="url(#level1Gradient)" rx="15" filter="url(#dropShadow)"/>
    <text x="210" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
      LEVEL 1: MINIMAL SECURITY
    </text>
    <text x="210" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">
      Ultra-Constrained Devices (32KB RAM, 8MHz)
    </text>
    
    <!-- Core Modules Only -->
    <text x="210" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      CORE MODULES ONLY
    </text>
    
    <rect x="70" y="150" width="70" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="105" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold">
      Auth
    </text>
    <text x="105" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Pre-shared
    </text>
    <text x="105" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Simple MAC
    </text>
    
    <rect x="150" y="150" width="70" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="185" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold">
      Encrypt
    </text>
    <text x="185" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      AES-128
    </text>
    <text x="185" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      ECB/CTR
    </text>
    
    <rect x="230" y="150" width="70" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="265" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold">
      Integrity
    </text>
    <text x="265" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      HMAC-
    </text>
    <text x="265" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      SHA256
    </text>
    
    <!-- Performance Specs -->
    <rect x="70" y="195" width="230" height="45" fill="#f0f9ff" rx="5" stroke="#0ea5e9" stroke-width="1"/>
    <text x="185" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
      PERFORMANCE SPECIFICATIONS
    </text>
    <text x="185" y="223" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      CPU Load: &lt;5% | Memory: &lt;8KB | Power: &lt;50µJ/op
    </text>
    <text x="185" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      Latency: &lt;1ms | Battery Impact: Minimal
    </text>
    
    <!-- Level 2: Standard IoT Devices -->
    <rect x="390" y="70" width="320" height="180" fill="url(#level2Gradient)" rx="15" filter="url(#dropShadow)"/>
    <text x="550" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
      LEVEL 2: STANDARD SECURITY
    </text>
    <text x="550" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">
      Typical IoT Devices (256KB RAM, 48MHz)
    </text>
    
    <!-- Core + Post-Quantum -->
    <text x="550" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      CORE + POST-QUANTUM MODULES
    </text>
    
    <rect x="410" y="150" width="60" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="440" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold">
      Auth
    </text>
    <text x="440" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Dilithium-2
    </text>
    <text x="440" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Signatures
    </text>
    
    <rect x="480" y="150" width="60" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="510" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold">
      KeyEx
    </text>
    <text x="510" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Kyber-512
    </text>
    <text x="510" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      KEM
    </text>
    
    <rect x="550" y="150" width="60" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="580" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold">
      Encrypt
    </text>
    <text x="580" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      AES-256
    </text>
    <text x="580" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      GCM
    </text>
    
    <rect x="620" y="150" width="60" height="35" fill="white" rx="5" opacity="0.95"/>
    <text x="650" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold">
      Session
    </text>
    <text x="650" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Key Mgmt
    </text>
    <text x="650" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Rotation
    </text>
    
    <!-- Performance Specs -->
    <rect x="410" y="195" width="230" height="45" fill="#f0f9ff" rx="5" stroke="#0ea5e9" stroke-width="1"/>
    <text x="525" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
      PERFORMANCE SPECIFICATIONS
    </text>
    <text x="525" y="223" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      CPU Load: &lt;15% | Memory: &lt;64KB | Power: &lt;500µJ/op
    </text>
    <text x="525" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      Latency: &lt;50ms | Battery: Moderate impact
    </text>
    
    <!-- Level 3: Advanced IoT Devices -->
    <rect x="730" y="70" width="320" height="180" fill="url(#level3Gradient)" rx="15" filter="url(#dropShadow)"/>
    <text x="890" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
      LEVEL 3: ENHANCED SECURITY
    </text>
    <text x="890" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">
      Advanced IoT Devices (1GB RAM, 1GHz)
    </text>
    
    <!-- Full Suite + Enhancements -->
    <text x="890" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      FULL PQC SUITE + ENHANCEMENTS
    </text>
    
    <rect x="750" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="775" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Auth
    </text>
    <text x="775" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      Dilithium-3
    </text>
    
    <rect x="810" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="835" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      KeyEx
    </text>
    <text x="835" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      Kyber-768
    </text>
    
    <rect x="870" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="895" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Certs
    </text>
    <text x="895" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      X.509
    </text>
    
    <rect x="930" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="955" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Threat
    </text>
    <text x="955" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      Detection
    </text>
    
    <rect x="990" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="1015" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Secure
    </text>
    <text x="1015" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      Storage
    </text>
    
    <!-- Optional Modules -->
    <rect x="750" y="190" width="60" height="20" fill="#fbbf24" rx="3" opacity="0.9"/>
    <text x="780" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Secure Boot
    </text>
    
    <rect x="820" y="190" width="60" height="20" fill="#fbbf24" rx="3" opacity="0.9"/>
    <text x="850" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Firmware Update
    </text>
    
    <rect x="890" y="190" width="60" height="20" fill="#fbbf24" rx="3" opacity="0.9"/>
    <text x="920" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Audit Logging
    </text>
    
    <rect x="960" y="190" width="60" height="20" fill="#fbbf24" rx="3" opacity="0.9"/>
    <text x="990" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7">
      Compliance
    </text>
    
    <!-- Performance Specs -->
    <rect x="750" y="220" width="290" height="25" fill="#f0f9ff" rx="5" stroke="#0ea5e9" stroke-width="1"/>
    <text x="895" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      CPU: &lt;25% | Memory: &lt;512KB | Power: &lt;5mJ/op | Latency: &lt;100ms
    </text>
    
    <!-- Level 4: Industrial IoT -->
    <rect x="1070" y="70" width="280" height="180" fill="url(#level4Gradient)" rx="15" filter="url(#dropShadow)"/>
    <text x="1210" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">
      LEVEL 4: MAXIMUM SECURITY
    </text>
    <text x="1210" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">
      Industrial IoT (&gt;2GB RAM, Multi-core)
    </text>
    
    <!-- Military-Grade -->
    <text x="1210" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      MILITARY-GRADE PROTECTION
    </text>
    
    <rect x="1090" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="1115" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      HSM
    </text>
    <text x="1115" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      Hardware
    </text>
    
    <rect x="1150" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="1175" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Kyber
    </text>
    <text x="1175" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      1024
    </text>
    
    <rect x="1210" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="1235" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      SPHINCS
    </text>
    <text x="1235" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      256
    </text>
    
    <rect x="1270" y="150" width="50" height="30" fill="white" rx="3" opacity="0.95"/>
    <text x="1295" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold">
      Audit
    </text>
    <text x="1295" y="173" text-anchor="middle" font-family="Arial, sans-serif" font-size="6">
      FIPS
    </text>
    
    <!-- Critical Features -->
    <rect x="1090" y="190" width="50" height="20" fill="#dc2626" rx="3" opacity="0.9"/>
    <text x="1115" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="white">
      Real-time
    </text>
    
    <rect x="1150" y="190" width="50" height="20" fill="#dc2626" rx="3" opacity="0.9"/>
    <text x="1175" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="white">
      Tamper Det
    </text>
    
    <rect x="1210" y="190" width="50" height="20" fill="#dc2626" rx="3" opacity="0.9"/>
    <text x="1235" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="white">
      Redundancy
    </text>
    
    <rect x="1270" y="190" width="50" height="20" fill="#dc2626" rx="3" opacity="0.9"/>
    <text x="1295" y="202" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="white">
      Forensics
    </text>
    
    <!-- Performance Specs -->
    <rect x="1090" y="220" width="230" height="25" fill="#f0f9ff" rx="5" stroke="#0ea5e9" stroke-width="1"/>
    <text x="1205" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">
      Configurable based on requirements &amp; resources
    </text>
  </g>

  <!-- Dynamic Module Selection Engine -->
  <rect x="50" y="280" width="1300" height="200" fill="white" rx="15" stroke="#1e40af" stroke-width="3" filter="url(#dropShadow)"/>
  <text x="700" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold">
    DYNAMIC MODULE SELECTION ENGINE
  </text>
  
  <!-- Selection Criteria -->
  <rect x="80" y="330" width="200" height="120" fill="#f0f9ff" rx="10" stroke="#0ea5e9" stroke-width="2"/>
  <text x="180" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
    SELECTION CRITERIA
  </text>
  
  <text x="90" y="370" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Device Capabilities:
  </text>
  <text x="90" y="383" font-family="Arial, sans-serif" font-size="9">
    • CPU speed &amp; architecture
  </text>
  <text x="90" y="393" font-family="Arial, sans-serif" font-size="9">
    • Available memory
  </text>
  <text x="90" y="403" font-family="Arial, sans-serif" font-size="9">
    • Power constraints
  </text>
  <text x="90" y="413" font-family="Arial, sans-serif" font-size="9">
    • Network bandwidth
  </text>
  
  <text x="90" y="430" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Security Requirements:
  </text>
  <text x="90" y="443" font-family="Arial, sans-serif" font-size="9">
    • Threat level assessment
  </text>
  
  <!-- Decision Matrix -->
  <rect x="300" y="330" width="400" height="120" fill="#f0fdf4" rx="10" stroke="#22c55e" stroke-width="2"/>
  <text x="500" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
    DECISION MATRIX &amp; ALGORITHM
  </text>
  
  <rect x="320" y="365" width="360" height="75" fill="#fefce8" rx="5" stroke="#eab308" stroke-width="1"/>
  <text x="500" y="380" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    MODULE SELECTION ALGORITHM
  </text>
  
  <text x="325" y="395" font-family="Courier New, monospace" font-size="8">
    if (cpu_capacity &lt; 16MHz AND memory &lt; 64KB):
  </text>
  <text x="335" y="405" font-family="Courier New, monospace" font-size="8">
    return LEVEL_1_MINIMAL_SECURITY
  </text>
  <text x="325" y="415" font-family="Courier New, monospace" font-size="8">
    elif (supports_pqc AND security_level &gt;= STANDARD):
  </text>
  <text x="335" y="425" font-family="Courier New, monospace" font-size="8">
    return select_optimal_pqc_config(capabilities)
  </text>
  <text x="325" y="435" font-family="Courier New, monospace" font-size="8">
    else: return adaptive_configuration(constraints)
  </text>
  
  <!-- Real-time Adaptation -->
  <rect x="720" y="330" width="280" height="120" fill="#fef3c7" rx="10" stroke="#f59e0b" stroke-width="2"/>
  <text x="860" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
    REAL-TIME ADAPTATION
  </text>
  
  <text x="730" y="370" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Trigger Conditions:
  </text>
  <text x="730" y="383" font-family="Arial, sans-serif" font-size="9">
    • Battery level drops below threshold
  </text>
  <text x="730" y="393" font-family="Arial, sans-serif" font-size="9">
    • Network bandwidth changes
  </text>
  <text x="730" y="403" font-family="Arial, sans-serif" font-size="9">
    • Security threat level elevation
  </text>
  <text x="730" y="413" font-family="Arial, sans-serif" font-size="9">
    • Performance degradation detected
  </text>
  
  <text x="730" y="430" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Adaptation Response:
  </text>
  <text x="730" y="443" font-family="Arial, sans-serif" font-size="9">
    • Graceful module reconfiguration (&lt;150ms)
  </text>
  
  <!-- Performance Optimization -->
  <rect x="1020" y="330" width="300" height="120" fill="#f3e8ff" rx="10" stroke="#8b5cf6" stroke-width="2"/>
  <text x="1170" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">
    PERFORMANCE OPTIMIZATION
  </text>
  
  <text x="1030" y="370" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Optimization Techniques:
  </text>
  <text x="1030" y="383" font-family="Arial, sans-serif" font-size="9">
    • Lazy module loading
  </text>
  <text x="1030" y="393" font-family="Arial, sans-serif" font-size="9">
    • Code path optimization
  </text>
  <text x="1030" y="403" font-family="Arial, sans-serif" font-size="9">
    • Memory pool management
  </text>
  <text x="1030" y="413" font-family="Arial, sans-serif" font-size="9">
    • Precomputation caching
  </text>
  
  <text x="1030" y="430" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Resource Efficiency:
  </text>
  <text x="1030" y="443" font-family="Arial, sans-serif" font-size="9">
    • 70-90% reduction vs monolithic approach
  </text>

  <!-- Protocol Stack Composition Examples -->
  <rect x="50" y="500" width="1300" height="350" fill="#f8fafc" rx="15" stroke="#64748b" stroke-width="2"/>
  <text x="700" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold">
    PROTOCOL STACK COMPOSITION EXAMPLES
  </text>
  
  <!-- Example 1: Smart Sensor -->
  <rect x="80" y="550" width="300" height="140" fill="url(#level1Gradient)" rx="10" filter="url(#dropShadow)"/>
  <text x="230" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
    EXAMPLE 1: SMART SENSOR
  </text>
  <text x="230" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
    Temperature sensor, battery powered, LoRaWAN
  </text>
  
  <rect x="100" y="605" width="260" height="75" fill="white" rx="5" opacity="0.95"/>
  <text x="230" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    SELECTED CONFIGURATION
  </text>
  
  <text x="110" y="635" font-family="Arial, sans-serif" font-size="9">
    <strong>Security Level:</strong> Level 1 (Minimal)
  </text>
  <text x="110" y="647" font-family="Arial, sans-serif" font-size="9">
    <strong>Modules:</strong> Pre-shared Auth + AES-128 + HMAC-SHA256
  </text>
  <text x="110" y="659" font-family="Arial, sans-serif" font-size="9">
    <strong>Resource Usage:</strong> 6KB RAM, 2% CPU, 35µJ/op
  </text>
  <text x="110" y="671" font-family="Arial, sans-serif" font-size="9">
    <strong>Battery Life:</strong> 5+ years, minimal security overhead
  </text>
  
  <!-- Example 2: Smart Home Hub -->
  <rect x="400" y="550" width="300" height="140" fill="url(#level2Gradient)" rx="10" filter="url(#dropShadow)"/>
  <text x="550" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
    EXAMPLE 2: SMART HOME HUB
  </text>
  <text x="550" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
    Home automation controller, WiFi connected
  </text>
  
  <rect x="420" y="605" width="260" height="75" fill="white" rx="5" opacity="0.95"/>
  <text x="550" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    SELECTED CONFIGURATION
  </text>
  
  <text x="430" y="635" font-family="Arial, sans-serif" font-size="9">
    <strong>Security Level:</strong> Level 2 (Standard Post-Quantum)
  </text>
  <text x="430" y="647" font-family="Arial, sans-serif" font-size="9">
    <strong>Modules:</strong> Kyber-512 + Dilithium-2 + AES-256
  </text>
  <text x="430" y="659" font-family="Arial, sans-serif" font-size="9">
    <strong>Resource Usage:</strong> 48KB RAM, 12% CPU, 420µJ/op
  </text>
  <text x="430" y="671" font-family="Arial, sans-serif" font-size="9">
    <strong>Performance:</strong> 35ms latency, quantum-safe
  </text>
  
  <!-- Example 3: Industrial Controller -->
  <rect x="720" y="550" width="300" height="140" fill="url(#level4Gradient)" rx="10" filter="url(#dropShadow)"/>
  <text x="870" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
    EXAMPLE 3: INDUSTRIAL PLC
  </text>
  <text x="870" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
    Critical infrastructure, real-time control
  </text>
  
  <rect x="740" y="605" width="260" height="75" fill="white" rx="5" opacity="0.95"/>
  <text x="870" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    SELECTED CONFIGURATION
  </text>
  
  <text x="750" y="635" font-family="Arial, sans-serif" font-size="9">
    <strong>Security Level:</strong> Level 4 (Military-Grade)
  </text>
  <text x="750" y="647" font-family="Arial, sans-serif" font-size="9">
    <strong>Modules:</strong> HSM + Kyber-1024 + SPHINCS+ + Audit
  </text>
  <text x="750" y="659" font-family="Arial, sans-serif" font-size="9">
    <strong>Resource Usage:</strong> 1.2MB RAM, 18% CPU, 1.8mJ/op
  </text>
  <text x="750" y="671" font-family="Arial, sans-serif" font-size="9">
    <strong>Compliance:</strong> FIPS 140-2, Common Criteria
  </text>
  
  <!-- Dynamic Adaptation Example -->
  <rect x="1040" y="550" width="280" height="140" fill="#0891b2" rx="10" filter="url(#dropShadow)"/>
  <text x="1180" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
    DYNAMIC ADAPTATION
  </text>
  <text x="1180" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">
    Real-time configuration changes
  </text>
  
  <rect x="1060" y="605" width="240" height="75" fill="white" rx="5" opacity="0.95"/>
  <text x="1180" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    ADAPTATION SCENARIOS
  </text>
  
  <text x="1070" y="635" font-family="Arial, sans-serif" font-size="9">
    <strong>Low Battery:</strong> Level 2 → Level 1 (extend life)
  </text>
  <text x="1070" y="647" font-family="Arial, sans-serif" font-size="9">
    <strong>High Threat:</strong> Level 2 → Level 3 (more security)
  </text>
  <text x="1070" y="659" font-family="Arial, sans-serif" font-size="9">
    <strong>Poor Network:</strong> Enable compression &amp; buffering
  </text>
  <text x="1070" y="671" font-family="Arial, sans-serif" font-size="9">
    <strong>Adaptation Time:</strong> &lt;150ms seamless transition
  </text>
  
  <!-- Interoperability Matrix -->
  <rect x="80" y="710" width="1240" height="120" fill="white" rx="10" stroke="#64748b" stroke-width="2"/>
  <text x="700" y="735" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold">
    INTEROPERABILITY &amp; COMPATIBILITY MATRIX
  </text>
  
  <!-- Compatibility Table -->
  <rect x="100" y="750" width="1200" height="70" fill="#f8fafc" rx="5"/>
  
  <!-- Headers -->
  <text x="120" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Security Level
  </text>
  <text x="250" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Target Devices
  </text>
  <text x="400" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Core Algorithms
  </text>
  <text x="580" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Optional Modules
  </text>
  <text x="750" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Performance
  </text>
  <text x="900" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Power Budget
  </text>
  <text x="1050" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Use Cases
  </text>
  <text x="1200" y="770" font-family="Arial, sans-serif" font-size="10" font-weight="bold">
    Compliance
  </text>
  
  <!-- Level 1 Row -->
  <text x="120" y="785" font-family="Arial, sans-serif" font-size="9">
    Level 1
  </text>
  <text x="250" y="785" font-family="Arial, sans-serif" font-size="8">
    8-bit MCU, 32KB
  </text>
  <text x="400" y="785" font-family="Arial, sans-serif" font-size="8">
    AES-128, HMAC
  </text>
  <text x="580" y="785" font-family="Arial, sans-serif" font-size="8">
    None
  </text>
  <text x="750" y="785" font-family="Arial, sans-serif" font-size="8">
    &lt;1ms, &lt;5% CPU
  </text>
  <text x="900" y="785" font-family="Arial, sans-serif" font-size="8">
    &lt;50µJ/op
  </text>
  <text x="1050" y="785" font-family="Arial, sans-serif" font-size="8">
    Sensors, Tags
  </text>
  <text x="1200" y="785" font-family="Arial, sans-serif" font-size="8">
    Basic IoT
  </text>
  
  <!-- Level 2 Row -->
  <text x="120" y="800" font-family="Arial, sans-serif" font-size="9">
    Level 2
  </text>
  <text x="250" y="800" font-family="Arial, sans-serif" font-size="8">
    32-bit ARM, 256KB
  </text>
  <text x="400" y="800" font-family="Arial, sans-serif" font-size="8">
    Kyber-512, Dilithium-2
  </text>
  <text x="580" y="800" font-family="Arial, sans-serif" font-size="8">
    Session Mgmt
  </text>
  <text x="750" y="800" font-family="Arial, sans-serif" font-size="8">
    &lt;50ms, &lt;15% CPU
  </text>
  <text x="900" y="800" font-family="Arial, sans-serif" font-size="8">
    &lt;500µJ/op
  </text>
  <text x="1050" y="800" font-family="Arial, sans-serif" font-size="8">
    Smart Home
  </text>
  <text x="1200" y="800" font-family="Arial, sans-serif" font-size="8">
    IoT Security
  </text>
  
  <!-- Level 3 Row -->
  <text x="120" y="815" font-family="Arial, sans-serif" font-size="9">
    Level 3/4
  </text>
  <text x="250" y="815" font-family="Arial, sans-serif" font-size="8">
    Multi-core, &gt;1GB
  </text>
  <text x="400" y="815" font-family="Arial, sans-serif" font-size="8">
    Full PQC Suite
  </text>
  <text x="580" y="815" font-family="Arial, sans-serif" font-size="8">
    All Available
  </text>
  <text x="750" y="815" font-family="Arial, sans-serif" font-size="8">
    Variable, Optimized
  </text>
  <text x="900" y="815" font-family="Arial, sans-serif" font-size="8">
    &lt;10mJ/op
  </text>
  <text x="1050" y="815" font-family="Arial, sans-serif" font-size="8">
    Industrial
  </text>
  <text x="1200" y="815" font-family="Arial, sans-serif" font-size="8">
    FIPS/CC
  </text>

  <!-- Flow Arrows -->
  <path d="M 210 250 L 210 280" stroke="#1e40af" stroke-width="3" fill="none" marker-end="url(#moduleArrow)"/>
  <path d="M 550 250 L 550 280" stroke="#1e40af" stroke-width="3" fill="none" marker-end="url(#moduleArrow)"/>
  <path d="M 890 250 L 890 280" stroke="#1e40af" stroke-width="3" fill="none" marker-end="url(#moduleArrow)"/>
  <path d="M 1210 250 L 1210 280" stroke="#1e40af" stroke-width="3" fill="none" marker-end="url(#moduleArrow)"/>
</svg>